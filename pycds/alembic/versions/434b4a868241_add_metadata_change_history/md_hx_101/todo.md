- [x] Use primary tables instead of views; retain hx tables
- [ ] Factor out some common code
- [x] Clean up code and documentation/comments
- [ ] xxx
- [ ] xxx
- [ ] xxx
- [ ] xxx
- [ ] xxx
- [ ] xxx